# React-ssr

a demo for learning react ssr

## How to use

```
yarn

yarn start

```

if you want to test mock, you should start another tab in zsh/bash to use code: 

```
node mock.js
```

then open link [http://localhost:9093](http://localhost:9093) in browser

## 同构

说到 SSR ，很多人第一反应是 “服务端渲染”， 但其实我们现在更倾向于称之为 ”同构“，

### 客户端渲染
客户端渲染模式下，页面加载通过服务端把渲染的 HTML 静态页面中展示内容，然后加载执行文件中的 js 代码（例如 react），再通过 根据 js 运行结果，生成相应 DOM并完成事件绑定，最后渲染给用户

#### 优点：
  1. 网络传输数据量小，减少服务器压力，
  2. 前后端分离，无需请求完整页面、交互好可实现各种效果

#### 缺点：
  1. 不利于 SEO，爬虫看不到完整的页面，
  2. 首屏渲染慢，（渲染前需要下载一堆 js 和 css 等）

### 服务端渲染
用户请求服务器，服务器上直接生成 HTML 内容并返回给客户端。服务器端渲染的页面内容是由服务器端生成的。
#### 优点：
  1. 首屏渲染快
  2. 利于 SEO
  3. 可生成静态化文件

#### 缺点：
  1. 传统服务端渲染用户体验差
  2. 代码不利于维护
  3. 服务器资源消耗大，并发压力大

### 同构 

这个概念存在于 Vue，React 这些前端框架中，实际上是客户端渲染和服务端渲染的一个整合。我们把页面展示内容和交互写在一起，让代码执行2次：
  1. 在服务端执行一次，用于实现服务端渲染，
  2. 在客户端再执行一次，用于接管页面交互

![ssr 原理实现图](/static/ssr.jpeg)

## 扩展

### 1. 接口报错处理

对每个请求列表单独进行错误处理的捕获，使其不报错

### 2. 前后端接口统一

  1. 服务端，使用 `express-http-proxy` 库对所有 `/api` 开头的请求进行代理
  2. 前端，改造全局 store， 使用中间件处理服务端请求和前端请求的接口地址转发
  3. 前端，action 调用接口时，使用封装好的 `axiosInstance` 进行接口调用